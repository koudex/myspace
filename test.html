<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Personal Space</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <style>
        :root {
            --primary: #252525;
            --accent: #8a2be2;
            --light: #f5f5f5;
            --dark: #1a1a1a;
            --text: #e0e0e0;
            --card-bg: #2d2d2d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--primary);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        html {
          overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header & Navigation */
        header {
            background-color: rgba(37, 37, 37, 0.9);
            position: fixed;
            width: 100%;
            z-index: 1000;
            padding: 15px 0;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        nav {
            display: flex;
            justify-content: justify;
            align-items: center;
            width: 100vw;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 20px;
        }

        .nav-links a {
            color: var(--text);
            text-decoration: none;
            font-weight: 500;
            font-size: .9rem;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: var(--accent);
        }

        .menu-btn {
            display: none;
            font-size: 1.5rem;
            cursor: pointer;
            position: relative;
            right: -13rem;
        }

        /* Hero Section */
        .hero {
            height: 100vh;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .hero-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1633356122544-f134324a6cee?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80') no-repeat center center/cover;
            opacity: 0.3;
            z-index: -1;
        }

        .hero-content {
            max-width: 600px;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 20px;
            background: linear-gradient(45deg, var(--accent), #ff00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 30px;
        }

        .btn {
            display: inline-block;
            padding: 12px 30px;
            background-color: var(--accent);
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }

        .btn:hover {
            background-color: #6a1cb9;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(138, 43, 226, 0.3);
        }

        /* Sections */
        section {
            padding: 80px 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 60px;
            font-size: 2.5rem;
            position: relative;
        }

        

        /* About Section */
        .about-content {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            align-items: center;
        }

        .about-text {
            flex: 1;
            min-width: 300px;
        }

        .about-image {
            flex: 1;
            min-width: 300px;
            text-align: center;
        }

        .about-image img {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            /* Add these properties for the border */
            border: 4px solid var(--accent);
            padding: 4px;
            box-sizing: border-box;
        }

        /* Interests Section */
        .interests-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .interest-card {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .interest-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .interest-icon {
            font-size: 2.5rem;
            color: var(--accent);
            margin-bottom: 20px;
        }

        /* Random Section */
        .random-container {
            background-color: var(--card-bg);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 40px;
        }

        .random-content {
            font-size: 1.5rem;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .random-type {
            color: var(--accent);
            font-weight: 600;
            margin-top: 10px;
        }

        /* Media Section */
        .media-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }

        .video-container, .music-container {
            flex: 1;
            min-width: 300px;
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
        }

        .video-player {
            width: 100%;
            border-radius: 10px;
            margin-top: 20px;
        }

        /* Music Player */
        .music-player {
            margin-top: 20px;
        }

        .track-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .track-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .track-artist {
            color: #aaa;
        }

        .progress-container {
            background-color: #444;
            height: 5px;
            border-radius: 5px;
            margin-bottom: 20px;
            pointer-events: none;
        }

        .progress {
            background-color: var(--accent);
            height: 100%;
            border-radius: 5px;
            width: 0%;
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .controls button {
            background: none;
            border: none;
            color: var(--text);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s;
        }

        .play-btn {
            font-size: 2rem !important;
        }

        /* Freedom Wall Section */
        .freedom-wall {
            padding: 80px 0;
            background-color: var(--dark);
        }

        .wall-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .message-form {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 40px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            background-color: #3a3a3a;
            border: 1px solid #555;
            border-radius: 8px;
            color: var(--text);
            font-family: 'Poppins', sans-serif;
            outline: none;
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .message-preview {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 40px;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .preview-content {
            text-align: center;
            width: 100%;
            overflow-wrap: break-word;
            transition: opacity 0.5s ease;
        }

        .preview-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 15px;
        }

        .preview-name {
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 10px;
        }

        .preview-message {
            font-style: italic;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .preview-time {
            font-size: 0.8rem;
            color: #aaa;
        }

        .view-all-btn {
            display: block;
            margin: 0 auto;
            text-align: center;
        }

        /* Thread Modal */
        .thread-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            overflow-x: hidden;
            overflow-wrap: break-word;
            padding: 20px;
        }

        .modal-content {
            background-color: var(--card-bg);
            max-width: 100vw;
            margin: 40px auto;
            border-radius: 15px;
            padding: 30px;
            position: relative;
            overflow-x: hidden;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.5rem;
            color: var(--text);
            background: none;
            border: none;
            cursor: pointer;
        }

        .thread-title {
            margin-bottom: 30px;
            text-align: center;
        }

        .messages-container {
            max-height: 60vh;
            overflow-x: hidden;
            padding-right: 10px;
        }

        .message-item {
            display: flex;
            margin-bottom: 25px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .message-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .message-content {
            flex-grow: 1;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .message-name {
            font-weight: 600;
            width: 170px;
            color: var(--accent);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .message-time {
            font-size: 0.8rem;
            color: #aaa;
        }

        .message-text {
            line-height: 1.5;
        }

        /* Footer */
        footer {
            background-color: var(--dark);
            padding: 40px 0;
            text-align: center;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .social-links a {
            color: var(--text);
            font-size: 1.5rem;
            transition: color 0.3s;
        }

        .social-links a:hover {
            color: var(--accent);
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 70px;
                left: 0;
                width: 100%;
                background-color: var(--primary);
                flex-direction: column;
                padding: 20px;
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .nav-links li {
                margin: 10px 0;
            }
            
            .menu-btn {
                display: block;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .about-content {
                flex-direction: column;
            }
            
            .media-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header & Navigation -->
    <header>
        <div class="container">
            <nav>
                <div class="logo">MySpace</div>
                <ul class="nav-links">
                    <li><a href="#about">About</a></li>
                    <li><a href="#interests">Interests</a></li>
                    <li><a href="#random">Random</a></li>
                    <li><a href="#music">Music</a></li>
                    <li><a href="#freedom-wall">Freedom Wall</a></li>
                </ul>
                <div class="menu-btn">
                    <i class="fas fa-bars"></i>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-bg"></div>
        <div class="container">
            <div class="hero-content" data-aos="fade-right">
                <h1>Hello, I'm Johnryll</h1>
                <p>Welcome to my personal corner of the internet!</p>
                <a href="#about" class="btn">Explore More</a>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">About Me</h2>
            <div class="about-content">
                <div class="about-image" data-aos="fade-left">
                    <img src="profile.png" alt="Profile Image">
                </div>
                <div class="about-text" data-aos="fade-right">
                    <p>Hey there! I'm Johnryll, 15 years old, currently a Grade 11 STEM student at DNHS. I'm a passionate developer and creative thinker with a love for technology and design. I enjoy creating things that live on the internet, whether that be websites, applications, or anything in between.</p>
                    <p>When I'm not coding, you can find me exploring new music, playing video games, or watching anime.</p>
                    <p>I created this website just for fun.</p>
                </div>
                
            </div>
        </div>
    </section>

    <!-- Interests Section -->
    <section id="interests" style="background-color: var(--dark);">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">My Interests</h2>
            <div class="interests-grid">
                <div class="interest-card" data-aos="fade-up" data-aos-delay="100">
                    <div class="interest-icon">
                        <i class="fas fa-laptop-code"></i>
                    </div>
                    <h3>Coding</h3>
                    <p>Mostly just vibe coding and experimenting with different technologies when the mood strikes. Not claiming to be an expert, but enjoying the process of creating things that work (most of the time).</p>
                </div>
                <div class="interest-card" data-aos="fade-up" data-aos-delay="200">
                  <div class="interest-icon">
                        <i class="fas fa-tv"></i>
                    </div>
                    <h3>Anime</h3>
                    <p>Love watching anime, especially romance, shounen, isekai, and comedy genres. I enjoy both mainstream hits and underrated masterpieces. When I find a good series, I'll binge-watch entire seasons even without sleep to catch up!</p>
                </div>
                <div class="interest-card" data-aos="fade-up" data-aos-delay="300">
                    <div class="interest-icon">
                        <i class="fas fa-gamepad"></i>
                    </div>
                    <h3>Gaming</h3>
                    <p>Casual ML player who enjoys gaming on my phone. I don't play everyday, but it's my go-to for relaxation and quick entertainment sessions</p>
                </div>
                <div class="interest-card" data-aos="fade-up" data-aos-delay="400">
                    <div class="interest-icon">
                        <i class="fas fa-music"></i>
                    </div>
                    <h3>Music</h3>
                    <p>I listen to mainstream music but I'm exploring different bands and artists to find what suits my style. I don't have a specific music taste - if it sounds good to me, I'll listen to it repeatedly</p>
                </div>
                <div class="interest-card" data-aos="fade-up" data-aos-delay="500">
                    <div class="interest-icon">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <h3>Reading</h3>
                    <p>When I find the time and motivation, I enjoy various genres including romance, thriller, tragedy, comedy, sci-fi, fantasy, and mystery novels.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Random Section -->
    <section id="random">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">Random Stuff</h2>
            <div class="random-container" data-aos="fade-up">
                <div class="random-content" id="random-content">
                    Click the button below to get a random joke, quote, or fact!
                </div>
                <button class="btn" id="random-btn">Generate Random</button>
                <div class="random-type" id="random-type"></div>
            </div>
        </div>
    </section>

    <!-- Media Section -->
    <section id="music" style="background-color: var(--dark);">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">Simple Music Player</h2>
            <div class="media-container">
                <!--<div class="video-container" data-aos="fade-right">
                    <h3>Random Video</h3>
                    <video class="video-player" controls autoplay muted loop>
                        <source src="videoplayback.mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>-->
                <div class="music-container" data-aos="fade-left">
                    <h3>walang magawa kahit tambak ng gawain</h3>
                    <div class="music-player">
                        <div class="track-info">
                            <div class="track-title">Song Title</div>
                            <div class="track-artist">Artist Name</div>
                        </div>
                        <div class="progress-container">
                            <div class="progress"></div>
                        </div>
                        <div class="controls">
                            <button id="prev"><i class="fas fa-step-backward"></i></button>
                            <button id="play" class="play-btn"><i class="fas fa-play"></i></button>
                            <button id="next"><i class="fas fa-step-forward"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Freedom Wall Section -->
    <section id="freedom-wall" class="freedom-wall">
        <div class="container wall-container">
            <h2 class="section-title" data-aos="fade-up">Freedom Wall</h2>
            
            <!-- Message Form -->
            <div class="message-form" data-aos="fade-up">
                <h3>Leave a Message</h3>
                <form id="wall-form">
                    <div class="form-group">
                        <label for="user-name">Your Name (optional)</label>
                        <input type="text" id="user-name" placeholder="Anonymous">
                    </div>
                    <div class="form-group">
                        <label for="user-message">Your Message</label>
                        <textarea id="user-message" placeholder="Write your message here..." required></textarea>
                    </div>
                    <button type="submit" class="btn">Post Message</button>
                </form>
            </div>
            
            <!-- Message Preview -->
            <div class="message-preview" data-aos="fade-up">
                <div class="preview-content" id="preview-content">
                    <img src="https://api.dicebear.com/6.x/bottts/svg?seed=Welcome" class="preview-avatar" alt="Avatar">
                    <div class="preview-name">Welcome to the Freedom Wall!</div>
                    <div class="preview-message">Be the first to leave a message. Your thoughts will appear here.</div>
                    <div class="preview-time">Just now</div>
                </div>
            </div>
            
            <button class="btn view-all-btn" id="view-thread-btn" data-aos="fade-up">View All Messages</button>
        </div>
    </section>
    
    <!-- Thread Modal -->
    <div class="thread-modal" id="thread-modal">
        <div class="modal-content">
            <button class="close-modal" id="close-modal">&times;</button>
            <h2 class="thread-title">Freedom Wall Thread</h2>
            <div class="messages-container" id="messages-container">
                <!-- Messages will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <!--<div class="social-links">
                <a href="#"><i class="fab fa-github"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-linkedin"></i></a>
            </div>-->
            <p>&copy; 2025 My Personal Space. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
    <script src="playlist.js"></script>
    <script>
    // Initialize AOS
    AOS.init({
        duration: 1000,
        once: false,
        offset: 100
    });

    // Mobile Menu Toggle
    const menuBtn = document.querySelector('.menu-btn');
    const navLinks = document.querySelector('.nav-links');

    menuBtn.addEventListener('click', () => {
        navLinks.classList.toggle('active');
    });

    // Close mobile menu when clicking on a link
    document.querySelectorAll('.nav-links a').forEach(link => {
        link.addEventListener('click', () => {
            navLinks.classList.remove('active');
        });
    });

    // Random Content Generator
    const randomBtn = document.getElementById('random-btn');
    const randomContent = document.getElementById('random-content');
    const randomType = document.getElementById('random-type');

    const jokes = [
        "Why don't scientists trust atoms? Because they make up everything!",
        "Why did the scarecrow win an award? Because he was outstanding in his field!",
        "Why don't skeletons fight each other? They don't have the guts.",
        "What do you call a fake noodle? An impasta!",
        "Why did the math book look sad? Because it had too many problems."
    ];

    const quotes = [
        "The only way to do great work is to love what you do. - Steve Jobs",
        "Innovation distinguishes between a leader and a follower. - Steve Jobs",
        "The future belongs to those who believe in the beauty of their dreams. - Eleanor Roosevelt",
        "The way to get started is to quit talking and begin doing. - Walt Disney",
        "Life is what happens when you're busy making other plans. - John Lennon"
    ];

    const facts = [
        "Honey never spoils. Archaeologists have found pots of honey in ancient Egyptian tombs that are over 3,000 years old and still perfectly edible.",
        "Octopuses have three hearts. Two pump blood to the gills, while the third pumps it to the rest of the body.",
        "The shortest war in history was between Britain and Zanzibar on August 27, 1896. Zanzibar surrendered after 38 minutes.",
        "A group of flamingos is called a 'flamboyance'.",
        "The world's oldest known recipe is for beer. It dates back about 5,000 years and was found in Sumeria (modern-day Iraq)."
    ];

    randomBtn.addEventListener('click', () => {
        const randomCategory = Math.floor(Math.random() * 3);
        
        switch(randomCategory) {
            case 0: // Joke
                const jokeIndex = Math.floor(Math.random() * jokes.length);
                randomContent.textContent = jokes[jokeIndex];
                randomType.textContent = "Joke";
                break;
            case 1: // Quote
                const quoteIndex = Math.floor(Math.random() * quotes.length);
                randomContent.textContent = quotes[quoteIndex];
                randomType.textContent = "Quote";
                break;
            case 2: // Fact
                const factIndex = Math.floor(Math.random() * facts.length);
                randomContent.textContent = facts[factIndex];
                randomType.textContent = "Fun Fact";
                break;
        }
    });

    // Music Player - Custom Implementation
    const playBtn = document.getElementById('play');
    const prevBtn = document.getElementById('prev');
    const nextBtn = document.getElementById('next');
    const trackTitle = document.querySelector('.track-title');
    const trackArtist = document.querySelector('.track-artist');
    const progress = document.querySelector('.progress');
    const progressContainer = document.querySelector('.progress-container');
    
    // Create time display elements
    const timeDisplay = document.createElement('div');
    timeDisplay.className = 'time-display';
    timeDisplay.style.display = 'flex';
    timeDisplay.style.justifyContent = 'space-between';
    timeDisplay.style.marginTop = '10px';
    timeDisplay.style.fontSize = '0.8rem';
    timeDisplay.style.color = '#aaa';
    
    const currentTimeEl = document.createElement('span');
    currentTimeEl.className = 'current-time';
    currentTimeEl.textContent = '0:00';
    
    const durationEl = document.createElement('span');
    durationEl.className = 'duration';
    durationEl.textContent = '0:00';
    
    timeDisplay.appendChild(currentTimeEl);
    timeDisplay.appendChild(durationEl);
    
    // Insert time display after progress container
    progressContainer.parentNode.insertBefore(timeDisplay, progressContainer.nextSibling);

    // Music player state
    let currentTrack = 0;
    let shuffledIndexes = [];
    let isPlaying = false;
    let audioElement = null;
    let progressUpdateInterval = null;
    let isSeeking = false;

    function formatTime(seconds) {
        if (isNaN(seconds)) return '0:00';
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }
    
    function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// Initialize the shuffled indexes
function initShuffledPlaylist() {
    // Create an array of indexes [0, 1, 2, ...]
    shuffledIndexes = Array.from({length: playlist.length}, (_, i) => i);
    // Shuffle the indexes
    shuffledIndexes = shuffleArray(shuffledIndexes);
}

    function loadTrack(index) {
      // Get the actual track index from our shuffled mapping
    const actualIndex = shuffledIndexes[index];
        // Clear any existing interval
        clearInterval(progressUpdateInterval);
        
        // Remove existing audio element if any
        if (audioElement) {
            audioElement.pause();
            audioElement.remove();
        }
        
        // Create new audio element
        audioElement = new Audio();
        audioElement.src = playlist[actualIndex].src;
        audioElement.preload = 'metadata';
        
        // Set up event listeners
        audioElement.addEventListener('loadedmetadata', function() {
            if (!isNaN(audioElement.duration) && audioElement.duration !== Infinity) {
                durationEl.textContent = formatTime(audioElement.duration);
            } else {
                // If duration is not available, try to get it another way
                setTimeout(() => {
                    if (!isNaN(audioElement.duration) && audioElement.duration !== Infinity) {
                        durationEl.textContent = formatTime(audioElement.duration);
                    }
                }, 1000);
            }
        });
        
        audioElement.addEventListener('ended', function() {
            nextTrack();
        });
        
        audioElement.addEventListener('error', function(e) {
            console.error('Audio error:', e);
            durationEl.textContent = '0:00';
        });
        
        trackTitle.textContent = playlist[actualIndex].title;
        trackArtist.textContent = playlist[actualIndex].artist;
        
        // Reset progress display
        progress.style.width = '0%';
        currentTimeEl.textContent = '0:00';
        
        // If we were playing, start the new track
        if (isPlaying) {
            playCurrentTrack();
        }
    }

    function updateProgress() {
        if (audioElement && !isSeeking && !isNaN(audioElement.duration) && audioElement.duration > 0) {
            const currentTime = audioElement.currentTime;
            const duration = audioElement.duration;
            const progressPercent = (currentTime / duration) * 100;
            
            progress.style.width = `${progressPercent}%`;
            currentTimeEl.textContent = formatTime(currentTime);
            
            // Update duration if not set yet
            if (durationEl.textContent === '0:00' && !isNaN(duration)) {
                durationEl.textContent = formatTime(duration);
            }
        }
    }

    function playCurrentTrack() {
        if (!audioElement) {
            loadTrack(currentTrack);
            return;
        }
        
        audioElement.play().then(() => {
            isPlaying = true;
            playBtn.innerHTML = '<i class="fas fa-pause"></i>';
            
            // Update progress regularly
            progressUpdateInterval = setInterval(updateProgress, 100);
        }).catch(error => {
            console.error("Playback failed:", error);
            isPlaying = false;
            playBtn.innerHTML = '<i class="fas fa-play"></i>';
        });
    }

    function pauseCurrentTrack() {
        if (audioElement) {
            audioElement.pause();
            isPlaying = false;
            playBtn.innerHTML = '<i class="fas fa-play"></i>';
            clearInterval(progressUpdateInterval);
        }
    }

    function togglePlayback() {
        if (isPlaying) {
            pauseCurrentTrack();
        } else {
            playCurrentTrack();
        }
    }

    function nextTrack() {
        currentTrack = (currentTrack + 1) % playlist.length;
        loadTrack(currentTrack);
    }

    function prevTrack() {
        // If more than 3 seconds into the song, restart it
        if (audioElement && audioElement.currentTime > 3) {
            seekToPosition(0);
            if (isPlaying) {
                playCurrentTrack();
            }
        } else {
            // Otherwise go to the previous track
            //pauseCurrentTrack();
            currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
            loadTrack(currentTrack);
            playCurrentTrack();
        }
    }
    
    // Initialize the shuffled playlist when the page loads
initShuffledPlaylist();
// Load the first track (which will be random due to shuffled indexes)
loadTrack(currentTrack);

    function seekToPosition(percent) {
        if (!audioElement || isNaN(audioElement.duration) || audioElement.duration <= 0) return;
        
        // Calculate the new position in seconds
        const newTime = percent * audioElement.duration;
        
        // Don't allow seeking beyond the track duration
        const clampedTime = Math.max(0, Math.min(newTime, audioElement.duration));
        
        // Set the seeking flag to prevent updateProgress from interfering
        isSeeking = true;
        
        // Set the new position
        audioElement.currentTime = clampedTime;
        
        // Update progress display immediately
        const progressPercent = (clampedTime / audioElement.duration) * 100;
        progress.style.width = `${progressPercent}%`;
        currentTimeEl.textContent = formatTime(clampedTime);
        
        // Clear the seeking flag after a short delay
        setTimeout(() => {
            isSeeking = false;
        }, 100);
    }

    function handleSeekEvent(clientX) {
        const rect = progressContainer.getBoundingClientRect();
        const clickX = clientX - rect.left;
        const width = rect.width;
        const percent = Math.max(0, Math.min(1, clickX / width));
        
        // Store whether we were playing before seeking
        const wasPlaying = isPlaying;
        
        // Pause if currently playing
        if (isPlaying) {
            pauseCurrentTrack();
        }
        
        // Seek to the new position
        seekToPosition(percent);
        
        // Resume playback if it was playing before
        if (wasPlaying) {
            playCurrentTrack();
        }
    }

    // Add event listeners
    playBtn.addEventListener('click', togglePlayback);
    nextBtn.addEventListener('click', nextTrack);
    prevBtn.addEventListener('click', prevTrack);
    
    // Desktop click event
    progressContainer.addEventListener('click', (e) => {
        handleSeekEvent(e.clientX);
    });

    // Mobile touch events
    let touchStartX = 0;
    
    progressContainer.addEventListener('touchstart', (e) => {
        e.preventDefault();
        touchStartX = e.touches[0].clientX;
        handleSeekEvent(touchStartX);
    });

    progressContainer.addEventListener('touchmove', (e) => {
        e.preventDefault();
        handleSeekEvent(e.touches[0].clientX);
    });

    progressContainer.addEventListener('touchend', (e) => {
        e.preventDefault();
    });

    // Load the first track
    loadTrack(currentTrack);

    // Freedom Wall Implementation
const wallForm = document.getElementById('wall-form');
const previewContent = document.getElementById('preview-content');
const viewThreadBtn = document.getElementById('view-thread-btn');
const threadModal = document.getElementById('thread-modal');
const closeModalBtn = document.getElementById('close-modal');
const messagesContainer = document.getElementById('messages-container');

// Function to clean up messages older than 24 hours
function cleanupOldMessages() {
    const now = new Date();
    const oneDayAgo = new Date(now.getTime() - (24 * 60 * 60 * 1000)); // 24 hours ago
    
    // Filter out messages older than 24 hours
    messages = messages.filter(msg => {
        const messageTime = new Date(msg.timestamp);
        return messageTime > oneDayAgo;
    });
    
    // Save the filtered messages back to localStorage
    localStorage.setItem('freedomWallMessagess', JSON.stringify(messages));
}

// Function to load messages with cleanup
function loadMessages() {
    messages = JSON.parse(localStorage.getItem('freedomWallMessagess')) || [];
    cleanupOldMessages(); // Remove messages older than 24 hours
}

// Store messages in localStorage
let messages = [];
loadMessages(); // Load and clean up messages

// Function to generate a random avatar URL using DiceBear API
function generateAvatarUrl(seed) {
    return `https://api.dicebear.com/9.x/bottts/svg?seed=${seed}`;
}

// Function to add a new message
function addMessage(name, message) {
    const timestamp = new Date().toISOString();
    const avatarSeed = name || 'Anonymous' + Date.now();
    const newMessage = {
        id: Date.now(),
        name: name || 'Anonymous',
        message: message,
        timestamp: timestamp,
        avatar: generateAvatarUrl(avatarSeed)
    };
    
    messages.unshift(newMessage); // Add to beginning of array (newest first)
    localStorage.setItem('freedomWallMessagess', JSON.stringify(messages));
    
    updatePreview();
    updateThread();
    
    return newMessage;
}

// Function to update the preview with the latest message
function updatePreview() {
    if (messages.length > 0) {
        const latestMessage = messages[0];
        
        // Create fade animation by changing opacity
        previewContent.style.opacity = 0;
        
        setTimeout(() => {
            previewContent.innerHTML = `
                <img src="${latestMessage.avatar}" class="preview-avatar" alt="Avatar">
                <div class="preview-name">${latestMessage.name}</div>
                <div class="preview-message">${latestMessage.message}</div>
                <div class="preview-time">${formatMessageTime(latestMessage.timestamp)}</div>
            `;
            
            // Fade back in
            previewContent.style.opacity = 1;
        }, 500);
    } else {
        // Show default message if no messages
        previewContent.innerHTML = `
            <img src="https://api.dicebear.com/9.x/bottts/svg?seed=Welcome" class="preview-avatar" alt="Avatar">
            <div class="preview-name">Welcome to the Freedom Wall!</div>
            <div class="preview-message">Be the first to leave a message. Your thoughts will appear here.</div>
            <div class="preview-time">Just now</div>
        `;
    }
}

// Function to format the timestamp for display
function formatMessageTime(timestamp) {
    const now = new Date();
    const messageTime = new Date(timestamp);
    const diffInSeconds = Math.floor((now - messageTime) / 1000);
    
    if (diffInSeconds < 60) {
        return 'Just now';
    } else if (diffInSeconds < 3600) {
        const minutes = Math.floor(diffInSeconds / 60);
        return `${minutes} min${minutes !== 1 ? 's' : ''} ago`;
    } else if (diffInSeconds < 86400) {
        const hours = Math.floor(diffInSeconds / 3600);
        return `${hours} hr${hours !== 1 ? 's' : ''} ago`;
    } else {
        const days = Math.floor(diffInSeconds / 86400);
        return `${days} day${days !== 1 ? 's' : ''} ago`;
    }
}

// Function to update the thread view
function updateThread() {
    messagesContainer.innerHTML = '';
    
    if (messages.length === 0) {
        messagesContainer.innerHTML = '<p class="no-messages">No messages yet. Be the first to leave one!</p>';
        return;
    }
    
    messages.forEach(msg => {
        const messageElement = document.createElement('div');
        messageElement.className = 'message-item';
        messageElement.innerHTML = `
            <img src="${msg.avatar}" class="message-avatar" alt="Avatar">
            <div class="message-content">
                <div class="message-header">
                    <div class="message-name">${msg.name}</div>
                    <div class="message-time">${formatMessageTime(msg.timestamp)}</div>
                </div>
                <div class="message-text">${msg.message}</div>
            </div>
        `;
        messagesContainer.appendChild(messageElement);
    });
}

// Function to cycle through messages in the preview
let previewIndex = 0;
function cyclePreviewMessages() {
    cleanupOldMessages(); // Clean up old messages each cycle
    
    if (messages.length > 0) {
        previewIndex = (previewIndex + 1) % messages.length;
        const message = messages[previewIndex];
        
        // Create fade animation
        previewContent.style.opacity = 0;
        
        setTimeout(() => {
            previewContent.innerHTML = `
                <img src="${message.avatar}" class="preview-avatar" alt="Avatar">
                <div class="preview-name">${message.name}</div>
                <div class="preview-message">${message.message}</div>
                <div class="preview-time">${formatMessageTime(message.timestamp)}</div>
            `;
            
            // Fade back in
            previewContent.style.opacity = 1;
        }, 500);
    }
}

// Event listener for form submission
wallForm.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const nameInput = document.getElementById('user-name');
    const messageInput = document.getElementById('user-message');
    
    const name = nameInput.value.trim();
    const message = messageInput.value.trim();
    
    if (message) {
        addMessage(name, message);
        messageInput.value = '';
        nameInput.value = '';
        
        // Show success feedback
        const submitBtn = this.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.textContent = 'Posted!';
        submitBtn.style.backgroundColor = '#4CAF50';
        
        setTimeout(() => {
            submitBtn.textContent = originalText;
            submitBtn.style.backgroundColor = '';
        }, 2000);
    }
});

// Event listeners for modal
viewThreadBtn.addEventListener('click', function() {
    updateThread();
    threadModal.style.display = 'block';
    document.body.style.overflow = 'hidden';
});

closeModalBtn.addEventListener('click', function() {
    threadModal.style.display = 'none';
    document.body.style.overflow = 'auto';
});

// Close modal when clicking outside
threadModal.addEventListener('click', function(e) {
    if (e.target === threadModal) {
        threadModal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
});

// Initialize the preview and thread
updatePreview();
updateThread();

// Start cycling through messages every 5 seconds if there are messages
if (messages.length > 0) {
    setInterval(cyclePreviewMessages, 5000);
}


    </script>
</body>
</html>